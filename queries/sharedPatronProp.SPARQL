PREFIX dc: <http://purl.org/dc/elements/1.1/>
PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>
PREFIX xl: <http://www.w3.org/2008/05/skos-xl#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX gvp: <http://vocab.getty.edu/ontology#>
PREFIX aat: <http://vocab.getty.edu/aat/>
PREFIX rel: <http://ldf.fi/schema/relations/>
PREFIX rlt: <http://ldf.fi/relations/types/>

CONSTRUCT {
  ?newURI rlt:sharedPatron ?newURI2
}
WHERE {

  ?personConcept a gvp:PersonConcept;
    gvp:prefLabelGVP/gvp:term [];
    foaf:focus [].

  ?personConcept2 a gvp:PersonConcept;
	gvp:prefLabelGVP/gvp:term [];
  	foaf:focus [].

  FILTER (?personConcept != ?personConcept2)

  ?patron gvp:ulan1201_patron_of ?personConcept;
          gvp:ulan1201_patron_of  ?personConcept2;
          gvp:prefLabelGVP/gvp:term [] .

  BIND(STRAFTER(str(?personConcept), "/ulan/") AS ?id)
  BIND(STRAFTER(str(?personConcept2), "/ulan/") AS ?id2)
  BIND(URI(CONCAT("http://ldf.fi/ulan/", ?id)) AS ?newURI)
  BIND(URI(CONCAT("http://ldf.fi/ulan/", ?id2)) AS ?newURI2)
}

